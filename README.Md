Code base written by Xinhui Wang, which we are revising.
